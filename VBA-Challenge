Sub VBA_Challenge()

'Create a Variable for Ticker_Symbol
Dim Ticker As String

'Determine Last Row
LastRow = ws.Cells(Rows.Count, 1).End(xlUp).Row

Ticker = Range("A2:A", LastRow)

'----------------------------------------------------------------------------------
Sub VBA_Challenge()

'Define a variable
Dim Ticker As String

    'Create a New Column for Ticker Symbols
    Cells(1, 9).Value = "Ticker_Symbol"

    'Determine Last Row
    LastRow = Cells(Rows.Count, 1).End(xlUp).Row
    
    'Loop Through to find Ticker Symbols
    
   For i = 2 To LastRow
        
        If Cells(i + 1, 1).Value <> Cells(i, 1).Value Then
            
            Ticker = Cells(i, 1).Value
            
            Range("I2:I620") = Ticker
            
        Else
            
            
        End If
        
    Next i

End Sub

'----------------------------------------------------------------------------------

MOST RECENT ATTEMPT 

''Create a script that will loop through all the stocks for one year
    'and output the following information.
'The ticker symbol.
'Yearly change from opening price at the beginning of a given year
    'to the closing price at the end of that year.
'The percent change from opening price at the beginning of a given
'year to the closing price at the end of that year.
'The total stock volume of the stock.
'You should also have conditional formatting that will highlight
    'positive change in green and negative change in red.

Sub Stock_Challenge()

'Create Columns for the desired outcomes
Range("I1") = "TICKER"
Range("J1") = "YRLY CHANGE"
Range("K1") = "% CHANGE"
Range("L1") = "TOTAL VOL"

'Create a Variable for Ticker Symbols
Dim Tick_Symbol As String

'Create a Table for the desired outcomes
Dim Table_Row As Integer
Table_Row = 2

'Define Opening Total
Dim Opening As Double
Opening = 0

'Define Closing Total
Dim Closing As Double
Closing = 0

'Define Volume Total
Dim Volume As Double
Volume = 0

'Define Yearly Change
Dim Yr_Change As Double

'Define Percent Change
Dim Percent_Changed As Double


    'Create a loop to find all Ticker Symbols
    For i = 2 To 2000
           
        'Create an IF state to find when a new ticker is presented
        If Cells(i, 1).Value <> Cells(i + 1, 1).Value Then
            
            'Create the new symbol equal to the variable
            Tick_Symbol = Cells(i, 1).Value
            
            'Add Ticker Symbol to the Table
            Cells(Table_Row, 9).Value = Tick_Symbol
            
            'Add Closing & Opening Values
            Opening = Opening + Cells(i, 3).Value
            Closing = Closing + Cells(i, 6).Value
            
            'Add Yearly Changed to the Table
            Yr_Change = (Closing - Opening)
            Cells(Table_Row, 10).Value = Yr_Change
                   
            'How to calculate percent changed
            Percent_Changed = Yr_Change / Opening
                
            'Add Percent Changed to the Table
            Cells(Table_Row, 11) = Percent_Changed
            
            'Sum Volume
            Volume = Volume + Cells(i, 7).Value
            'Add Total Volume to the Table
            Cells(Table_Row, 12) = Volume
            
            'Go to the next Row for the next symbol
            Table_Row = Table_Row + 1
            
            'Clear opening & closing & Volume count
            Opening = 0
            Closing = 0
            Volume = 0
            
        Else
            'When the same ticker add up Opening & Closing & Value
            Opening = Opening + Cells(i, 3).Value
            Closing = Closing + Cells(i, 6).Value
            Volume = Volume + Cells(i, 7).Value
            
        End If
    
    Next i
    
    'Create a new loop to target Table Yrly Change
    For i = 2 To 100
        
        'Conditional Formatting that will highlight positive change in green
        If Cells(i, 10).Value > 0 Then
        Cells(i, 10).Interior.ColorIndex = 4
        
        'Conditional Formatting that will highlight positive change in red
        ElseIf Cells(i, 10).Value < 0 Then
        Cells(i, 10).Interior.ColorIndex = 3
        
        End If
    
    Next i

'Change the Formatting of column K to be a percent
Range("K:K").NumberFormat = "0.00%"

Range("O1") = "TICKER"
Range("P1") = "VALUE"

Range("N2", "N3").NumberFormat = "0.00%"

Cells(2, 14).Value = "Greatest % increase"
Cells(3, 14).Value = "Greatest % decrease"
Cells(4, 14).Value = "Greatest Total Vol"

Dim Max As Double
Dim Min As Double
Dim Greatest_Vol As Double

Percent_Range = Range("K:K").Value
Volume_Range = Range("L:L").Value

    For i = 2 To 200
        
    Max = WorksheetFunction.Max(Percent_Range)
    Min = WorksheetFunction.Min(Percent_Range)
    Greatest_Vol = WorksheetFunction.Max(Volume_Range)
        
        If Cells(i, 11).Value = Max Then
        Cells(2, 16).Value = Max
        Cells(2, 16).NumberFormat = "0.00%"
        Cells(2, 15).Value = Cells(i, 9).Value
        
        ElseIf Cells(i, 11).Value = Min Then
        Cells(3, 16).Value = Min
        Cells(3, 16).NumberFormat = "0.00%"
        Cells(3, 15).Value = Cells(i, 9).Value
        
        ElseIf Cells(i, 12).Value = Greatest_Vol Then
        Cells(4, 16).Value = Greatest_Vol
        Cells(4, 15).Value = Cells(i, 9).Value
                
        End If
        
    Next i

End Sub
